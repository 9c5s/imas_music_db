---
# Bunç§»è¡Œãƒ†ã‚¹ãƒˆå°‚ç”¨ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
name: Bunç§»è¡Œãƒ†ã‚¹ãƒˆ

# æ‰‹å‹•å®Ÿè¡Œã®ã¿
on:
  workflow_dispatch: null

jobs:
  test-bun-migration:
    runs-on: ubuntu-latest
    name: Bunç§»è¡Œå‹•ä½œãƒ†ã‚¹ãƒˆ
    steps:
      # ã‚¹ãƒ†ãƒƒãƒ—1: ãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ
      - name: 1. ãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ
        uses: actions/checkout@v4

      # ã‚¹ãƒ†ãƒƒãƒ—2: ãƒ†ã‚¹ãƒˆç”¨ãƒ€ãƒŸãƒ¼JSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
      - name: 2. ãƒ†ã‚¹ãƒˆç”¨ãƒ€ãƒŸãƒ¼JSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
        run: |
          echo '{
            "songs": [
              {"id": 1, "title": "ãƒ†ã‚¹ãƒˆã‚½ãƒ³ã‚°1", "artist": "ãƒ†ã‚¹ãƒˆã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆ1"},
              {"id": 2, "title": "ãƒ†ã‚¹ãƒˆã‚½ãƒ³ã‚°2", "artist": "ãƒ†ã‚¹ãƒˆã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆ2"}
            ],
            "metadata": {
              "generated_at": "2025-07-11T23:55:00Z",
              "total_count": 2
            }
          }' > test_data.json
          echo "âœ… ãƒ†ã‚¹ãƒˆç”¨JSONãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚Œã¾ã—ãŸ"
          cat test_data.json

      # ã‚¹ãƒ†ãƒƒãƒ—3: Bunç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
      - name: 3. Bunç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
        uses: oven-sh/setup-bun@v2
        with:
          bun-version: 'latest'

      # ã‚¹ãƒ†ãƒƒãƒ—4: Bunã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª
      - name: 4. Bunãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª
        run: |
          echo "=== Bunæƒ…å ± ==="
          bun --version
          which bun
          echo "âœ… BunãŒæ­£å¸¸ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¾ã—ãŸ"

      # ã‚¹ãƒ†ãƒƒãƒ—5: Prettierã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
      - name: 5. Prettierã‚’Bunã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
        run: |
          echo "=== Prettierã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«é–‹å§‹ ==="
          bun add -g prettier
          echo "âœ… PrettierãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¾ã—ãŸ"

      # ã‚¹ãƒ†ãƒƒãƒ—6: Prettierã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª
      - name: 6. Prettierãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª
        run: |
          echo "=== Prettieræƒ…å ± ==="
          prettier --version
          which prettier
          echo "âœ… PrettierãŒæ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã¾ã™"

      # ã‚¹ãƒ†ãƒƒãƒ—7: Prettierã§JSONã‚’ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
      - name: 7. Prettierã§JSONã‚’ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
        run: |
          echo "=== ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå‰ã®JSONãƒ•ã‚¡ã‚¤ãƒ« ==="
          cat test_data.json
          echo ""
          echo "=== Prettierã«ã‚ˆã‚‹ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå®Ÿè¡Œ ==="
          prettier --write test_data.json
          echo "=== ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå¾Œã®JSONãƒ•ã‚¡ã‚¤ãƒ« ==="
          cat test_data.json
          echo "âœ… JSONãƒ•ã‚¡ã‚¤ãƒ«ãŒPrettierã§ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã•ã‚Œã¾ã—ãŸ"

      # ã‚¹ãƒ†ãƒƒãƒ—8: ãƒ†ã‚¹ãƒˆçµæœã®ç·æ‹¬
      - name: 8. ãƒ†ã‚¹ãƒˆçµæœç·æ‹¬
        run: |-
          echo "ğŸ‰ === Bunç§»è¡Œãƒ†ã‚¹ãƒˆå®Œäº† ==="
          echo "âœ… setup-bun@v2: æ­£å¸¸å‹•ä½œ"
          echo "âœ… bun add -g prettier: æ­£å¸¸å‹•ä½œ"
          echo "âœ… Prettierãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ: æ­£å¸¸å‹•ä½œ"
          echo ""
          echo "ğŸ“‹ ãƒ†ã‚¹ãƒˆç’°å¢ƒæƒ…å ±:"
          echo "- OS: $(uname -a)"
          echo "- Bun: $(bun --version)"
          echo "- Prettier: $(prettier --version)"
          echo ""
          echo "âœ… Node.js â†’ Bunç§»è¡Œã¯æ­£å¸¸ã«å‹•ä½œã™ã‚‹ã“ã¨ãŒç¢ºèªã•ã‚Œã¾ã—ãŸ"
